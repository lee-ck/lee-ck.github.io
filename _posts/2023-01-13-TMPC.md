---
layout: single
title:  "Tube-based MPC"
tags: [TubeMPC, MPC, All]
comments: true
author_profile: false
toc: true
---
모델의 불확실성, 외란이 존재할 때 Robust MPC 알고리즘 중 대표적인 방법.
Reachability 개념 + MPC 


> ***Definition 1***. RPI set of the LTI system
> 
> A set $\Omega \subset \mathbb{R}^n$ is a robust invariant set (RPI) set of the LTI system $x^+ = Ax + w$, if $Ax+w \in \Omega$ for all $x \in \Omega$ and $w\in \mathbb{W}$.
> 

불확실성이 존재하는 시스템:

$$
\begin{aligned}
    {x}_{k+1} = A {x}_k &+ B {u}_k + {w}_k, \\
\text{s.t. }{x}_k  &\in \mathbb{X}, \\
                {u}_k  &\in \mathbb{U}, 
\end{aligned}
$$

> Let ${w}_k \in \mathbb W \subset \mathbb{R}^n$ be a bounded disturbance vector.
(필수 가정)

The nominal system (불확실성 제외한 시스템):

$$
{z}_{k+1} = A{z}_k + B{\bar{u}}_k,
$$

${\bar{u}}_k$ : Nominal input 
${z}_k$ : Nominal state


**The control input of the TMPC is defined as follows:**
$$
 {u}_k= {\bar{u}}_k + K({x}_k-{z}_k),
 $$

$K$ : Auxiliary state feedback control

Let ${e}_k = {x}_k - {z}_k$ : Error vector

에러 시스템은 다음과 같이 정의됨:

$$
\begin{aligned} 
{e}_{k+1} & = A({x}_k-{z}_k) + B({u}_k - {\bar{u}}_k) + {w}_k 
\\ 
    &  = (A + BK) {e}_k + {w}_k.
\end{aligned}
$$

만양 $A + BK $ 이 Schur stable 하다면 에러 시스템의 RPI set $\mathbb{S}$ 은 아래의 알고리즘으로 계산이 가능함.

![title](/fig/RPI_algorithm.png){: width="400"}{: .align-center}



For typical systems, an outer $\epsilon$-approximation is usually used because it requires many iterations to satisfy the termination condition in line~\ref{al:eps} of an \Cref{algorithm:LTI_RPI} \cite{rakovic2005invariant}. Finally, the control input of the nominal MPC is computed with constraints tightened by the RPI set as follows:
\begin{equation} 
\begin{aligned} 
    \min_{\mathbf{z}_{(\cdot)},{\mathbf{\bar{u}}}_{(\cdot)}} \sum_{k=0}^{N-1}  l(&\mathbf{z}_k,\mathbf{\bar{u}}_k)+l_f(\mathbf{z}_N),   \\ 
    \text{s.t. } 
    \mathbf{z}_{k+1} &= A\mathbf{z}_k + B\mathbf{\bar{u}}_k,   \\
    \mathbf{z}_k &\in \mathbb{X} \ominus \mathbb{S},   \\
    \mathbf{\bar{u}}_k &\in \mathbb{U} \ominus K \mathbb{S}, \\
    \mathbf{z}_N &\in \mathbb{X}_f \ominus \mathbb{S},
\end{aligned}
\end{equation}
where $N$ is the prediction horizon, $l(\mathbf{z}_k,\mathbf{\bar{u}}_k)$ is the stage cost, $l_f(\mathbf{z}_N)$ is the terminal cost, and $\mathbb{X}_f$ is the terminal constraints.





## Reference

[1] D.Q.Mayne et al., "[Robust model predictive control of constrained linear systems with bounded disturbances](https://www.sciencedirect.com/science/article/pii/S0005109804002870)", Automatica 2005

[2] Borrelli et al., "[Predictive Control for Linear and Hybrid Systems](http://www.mpc.berkeley.edu/mpc-course-material)", Cambridge University Press, 2017
&rarr; UC Berkeley MPC Lab (Prof. Borrelli) 홈페이지 참고

[3] Raković et al., "[Handbook of model predictive control](https://books.google.co.kr/books?hl=ko&lr=&id=I3VsDwAAQBAJ&oi=fnd&pg=PR7&dq=Handbook+of+Model+Predictive+Control&ots=cYbWddt2H-&sig=0mYkxV24zMX_gDIQH6YMExPuosM#v=onepage&q=Handbook%20of%20Model%20Predictive%20Control&f=false)", Springer 2018.
