---
layout: single
title:  "Model Predictive Control"
tags: [MPC, All]
comments: true
author_profile: false
toc: true
---
## What is Model Predictive Control (MPC) ?
![title](/fig/MPC_intro.jpg)

[[Image from Prof.Rolf Findeisen's slides](http://ifatwww.et.uni-magdeburg.de/syst/cdc2012/workshopallslides.pdf)]

**Pros**
- Proactive behavior
- State and input constraints
- Any model
- Any objective
- ...

**Cons**
- Computational complexity
- May not be feasible
- May not be stable
- Unceratinty
- ...
  
## Mathematical Formulation
$$
\text{min} \sum^{N-1}_{k=0}q(x_{t+k},u_{t+k}) +p(x_{t+N}) 
$$

subject to
$$
x_t = x(t) \\
x_{t+k+1} = f(x_{t+k},u_{t+k})\\
x_{t+k}\in \mathbb{X}\\
u_{t+k}\in \mathbb{U}\\
x_{t+N}\in \mathbb{X_f}\\
$$

모델 $f$가 비선형이면 Nonlinear MPC (NMPC), 선형이면 Linear MPC (LMPC).

매 time step에 위의 optimization problem을 풀어야함.

$\mathbb{X_f}$ : Terminal region, $p(x)$ : Terminal cost

이 두가지를 이용하여 feasibility, stability를 보장할 수 있음. (일반적으로 NMPC에는 적용하기 어려움)

## Examples (Github links)
(연습 삼아 만들었던 것들)

[Vehicle example](https://github.com/lee-ck/Model-Predictive-Control)
![title](/fig/result_gif.gif){: width="350" height="350"}{: .align-center}


[Pendulum example](https://github.com/lee-ck/Inverted-pendulum-on-a-cart-control---MPC-LQR-PID)
![title](/fig/MPC_Invert.gif){: width="400" height="400"}{: .align-center}


## What is Model Predictive Control (MPC) ?


## Papers & Books & Authors (Recommended)

### **Papers**

D.Q.Mayne et al., "[Constrained model predictive control: Stability and optimality](https://www.sciencedirect.com/science/article/pii/S0005109899002149)", Automatica 2000

D.Q.Mayne et al., "[Robust model predictive control of constrained linear systems with bounded disturbances](https://www.sciencedirect.com/science/article/pii/S0005109804002870)", Automatica 2005

Andersson et al., "[CasADi: a software framework for nonlinear optimization and optimal control](https://web.casadi.org/)", Mathematical Programming Computation 2019

Houska et al., "[ACADO toolkit—An open‐source framework for automatic control and dynamic optimization](https://acado.github.io/)", Optimal Control Applications and Methods 2011
&rarr; 최근에는 [acados](https://docs.acados.org/)라는 software로 넘어감.

Mina Kamel et al., "[Linear vs Nonlinear MPC for Trajectory Tracking Applied to Rotary Wing Micro Aerial Vehicles](https://arxiv.org/abs/1611.09240)", IFAC 2017

Aleksander Veksler et al., "[Dynamic Positioning With Model Predictive Control](https://ieeexplore.ieee.org/abstract/document/7386641)", IEEE Transactions on Control Systems Technology 2016

Michael Neunert et al., "[Fast Nonlinear Model Predictive Control for Unified Trajectory Optimization and Tracking](https://ieeexplore.ieee.org/document/7487274)", ICRA 2016

Mattingley et al., "[CVXGEN: A code generator for embedded convex optimization](https://cvxgen.com/docs/index.html)", Optimization and Engineering 2012


### **Books**

Borrelli et al., "[Predictive Control for Linear and Hybrid Systems](http://www.mpc.berkeley.edu/mpc-course-material)", Cambridge University Press, 2017
&rarr; UC Berkeley MPC Lab (Prof. Borrelli) 홈페이지 참고

Raković et al., "[Handbook of model predictive control](https://books.google.co.kr/books?hl=ko&lr=&id=I3VsDwAAQBAJ&oi=fnd&pg=PR7&dq=Handbook+of+Model+Predictive+Control&ots=cYbWddt2H-&sig=0mYkxV24zMX_gDIQH6YMExPuosM#v=onepage&q=Handbook%20of%20Model%20Predictive%20Control&f=false)", Springer 2018.


### **Authors**

[Francesco Borrelli](https://scholar.google.co.kr/citations?user=Cz-Q_IsAAAAJ&hl=ko&oi=ao),
[Manfred Morari](https://scholar.google.co.kr/citations?user=JiW8z50AAAAJ&hl=ko&oi=sra),
[David Mayne](https://scholar.google.co.kr/citations?user=0d7Yj9sAAAAJ&hl=ko&oi=sra),
[Moritz Diehl](https://scholar.google.co.kr/citations?user=JEwMX6wAAAAJ&hl=ko&oi=sra),
[Yiqi Gao](https://scholar.google.co.kr/citations?user=yX4ibDoAAAAJ&hl=ko&oi=ao),
[Saša V. Raković](https://scholar.google.co.kr/citations?user=8qIjI0EAAAAJ&hl=ko&oi=sra),
[Rolf Findeisen](https://scholar.google.com/citations?user=51blT9cAAAAJ&hl=en)



**관련 알고리즘들:
Active set, Interior point, Sequential Quadratic Programming (SQP), etc ...**

**관련 Softwares: 
ACADO, ACADOs, IPOPT, CVXGEN, CVXPY, etc ...**